<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.0.9/dist/aframe-particle-system-component.min.js"></script>
  </head>
  <body>
    <script>
        AFRAME.registerComponent('follow', {
            target: {type: 'seletor'},
            speed: {type: 'number'}
        })

          AFRAME.registerComponent('ida-volta', {
            schema: {
          xMin: { type: 'number', default: -3 }, // Limite mínimo no eixo X
          xMax: { type: 'number', default: 3 },  // Limite máximo no eixo X
          speed: { type: 'number', default: 2 }, // Velocidade do movimento
          depth: { type: 'number', default: -2 } // Profundidade do "U" (menor valor de Y)
        },
        init: function () {
          this.time = 0; // Variável para rastrear o tempo acumulado
        },
        tick: function (time, timeDelta) {
          const delta = (timeDelta / 1000) * this.data.speed; // Incremento baseado na velocidade
          this.time += delta;

          // Calculando o progresso do movimento como uma função oscilante suave
          const progress = Math.sin(this.time); // Oscilação suave (vai de -1 a 1)

          // Atualizando a posição do objeto
          const position = this.el.object3D.position;

          // Eixo X: Oscila entre xMin e xMax
          position.x = this.data.xMin + (progress + 1) / 2 * (this.data.xMax - this.data.xMin);

          // Eixo Y: Cria uma curva suave com formato de "U"
          position.y = this.data.depth - Math.cos(progress * Math.PI) * Math.abs(this.data.depth);
        }
      });

      AFRAME.registerComponent('skate', {
        schema: {
          xMin: { type: 'number', default: -3 }, // Limite mínimo no eixo X
          xMax: { type: 'number', default: 3 },  // Limite máximo no eixo X
          speed: { type: 'number', default: 2 }, // Velocidade do movimento
          depth: { type: 'number', default: -2 } // Profundidade do "U" (menor valor de Y)
        },
        init: function () {
          // Criando a base, rodas e chassi dentro do componente 'skate'
          // Base do skate (plataforma principal)
          this.base = document.createElement('a-box');
          this.base.setAttribute('position', '0 0.1 -3');
          this.base.setAttribute('width', '2');
          this.base.setAttribute('height', '0.1');
          this.base.setAttribute('depth', '0.5');
          this.base.setAttribute('color', '#8B4513');
          this.el.appendChild(this.base);

          // Rodas do skate
          this.createRoda(-0.8, 0, -3.2);
          this.createRoda(0.8, 0, -3.2);
          this.createRoda(-0.8, 0, -2.8);
          this.createRoda(0.8, 0, -2.8);

          // Chassi do skate (parte superior)
          this.chassi = document.createElement('a-box');
          this.chassi.setAttribute('position', '0 0.15 -3');
          this.chassi.setAttribute('width', '2');
          this.chassi.setAttribute('height', '0.01');
          this.chassi.setAttribute('depth', '0.5');
          this.chassi.setAttribute('color', 'black');
          this.el.appendChild(this.chassi);

          this.time = 0; // Variável para rastrear o tempo acumulado
        },

        // Função para criar as rodas
        createRoda: function (x, y, z) {
          const roda = document.createElement('a-cylinder');
          roda.setAttribute('position', `${x} ${y} ${z}`);
          roda.setAttribute('rotation', '90 0 0')
          roda.setAttribute('radius', '0.1');
          roda.setAttribute('height', '0.2');
          roda.setAttribute('color', 'yellow');
          this.el.appendChild(roda);
        },


      });

    </script>

    <a-scene physics>
    <a-entity skate="xMin: -5; xMax:5; speed:1.5; depth: -1.5" ida-volta></a-entity>
      <a-box id="target-box" ida-volta="xMin: -10; xMax: 10; speed: 2; depth: -2S" position="-1 0.5 -10" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sky color="#ECECEC"></a-sky>    </a-scene>
  </body>
</html>